{% extends 'events/base.html' %}
{% block content %}
<h2 class="mb-4">Riwayat Kegiatan Saya</h2>

<div class="row">
    {% for act in activities %}
    <div class="col-md-12 mb-3">
        <div class="card border-0 shadow-sm">
            <div class="card-body d-flex justify-content-between align-items-center">
                <div>
                    <h5 class="fw-bold">{{ act.event.title }}</h5>
                    <p class="mb-1 text-muted">
                        {{ act.event.date_time|date:"d M Y" }} | 
                        
                        {% if act.is_verified %}
                            <span class="badge bg-success">Terverifikasi</span>
                        {% else %}
                            <span class="badge bg-warning text-dark">Pending</span>
                        {% endif %}

                        {% if act.event.status == 'finished' %}
                            <span class="badge bg-primary">Selesai</span>
                        {% endif %}
                    </p>
                </div>
                
                <div class="text-end">
                    {% if act.is_verified %}
                        {% if act.event.status == 'finished' %}
                            <a href="{% url 'generate_certificate' act.validation_id %}" class="btn btn-primary btn-sm mb-1">
                                ğŸ† Download Sertifikat
                            </a>
                        {% else %}
                            <button class="btn btn-secondary btn-sm mb-1" disabled title="Menunggu Organizer menyelesaikan acara">
                                â³ Sertifikat Belum Tersedia
                            </button>
                        {% endif %}
                    {% else %}
                         <span class="text-danger small">Lakukan Pembayaran</span>
                    {% endif %}
                    
                    <br>
                    <a href="{% url 'event_detail' act.event.slug %}" class="btn btn-outline-secondary btn-sm mt-1">Lihat Detail Event</a>
                </div>
            </div>
        </div>
    </div>
    {% empty %}
    <div class="col-12 text-center py-5">
        <p class="text-muted">Anda belum mengikuti kegiatan apapun.</p>
        <a href="{% url 'home' %}" class="btn btn-primary">Cari Kegiatan</a>
    </div>
    {% endfor %}
</div>
{% endblock %}